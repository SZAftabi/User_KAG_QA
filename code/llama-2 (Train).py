# -*- coding: utf-8 -*-
"""Llama-2 (Tag generation).ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1VM2X2Z-ft0xw8M2-NUGVbwy6wH-cFza6
"""

DataPath = "PATH/TO/YOUR/DATA" #Example: f'{Drive_path}NewFolder/MyData.pkl'
MyData = pd.read_pickle(DataPath)
MyData = MyData[['text', 'newtags']]
MyData.rename(columns = {'newtags': 'tags'}, inplace = True)

DataModule = TGDataModule(MyData, MyModel.tokenizer, script_args))
MyModel = TGModel(script_args)
logger = TensorBoardLogger(script_args.output_dir + 'logs', name="TG")

trainer = pl.Trainer(
    logger = logger,
    log_every_n_steps = script_args.logging_steps,
    max_epochs = script_args.max_epochs,
    accumulate_grad_batches = script_args.gradient_accumulation_steps,
    num_sanity_val_steps = script_args.num_sanity_val_steps,
    callbacks = [OverrideEpochStepCallback(), checkpoint_callback],
    )

trainer.fit(MyModel, datamodule=DataModule)